---
title: J2EE-Hibernate的核心接口
catagories: J2EE-Hibernate
---
# 简介
> Hibernate作为持久成中间件，它的具体实现对与上层调用是透明的，即上层通过接口来调用Hibernate的具体实现，所以对于入门级别的讨论来说，自然应该先从接口开始了。
 
所有的Hibernate应用都会访问它的5个核心接口，分别如下：
- Configuration接口：
- SessionFactory接口：
- Session接口：
- Transaction接口：

# Configuration接口
> **Configuration用于配置并启动Hibernate。Hibernate应用通过Configuration的实例来指定对象-关系映射文件** ,或通过Configuration动态配置Hibernate的属性，然后通过Configuration来创建相应的SessionFactory实例。Configuration实例是什么时候指定ORM文件的地址的呢？我们可以查看Configuration的源代码，它的configure()方法是这样实现的：

``` java
public Configuration configure() throws HibernateException {
       configure( "/hibernate.cfg.xml" );//此处指定了ORM文件的位置
       return this;
   }
```
原来它是在这里指定了ORM文件的位置，**这就是为什么Hibernate总是默认到classpath下去寻找hibernate.cfg.xml 文件的原因了。**  <font color='red'>实际上我们还可以通过configure(String resource)来动态的指定配置文件</font>，只不过通常我们都是采用的默认设置罢了。这样的话我们的配置文件就都被读取了，同时配置文件中通 过<mapping>元素引入的映射文件也被读取了。

# SessionFactory接口

一个SessionFactory对应一个数据源，它是个重量级对象，不可随意生成多个实例。对于一般的单数据库应用来说，只需要一个 SessionFactory就足够了。当然如果有多个数据库的话，还是需要为每个数据库生成对应的SessionFactory？一般而言，**一个SessionFactory对象就代表一个数据库存储源**。它是线程安全的，同一 个实例可以被应用中的多个线程共享。由此我们看出SessionFactory具备如下两个特点：
1. 线程安全。整个应用共用一个SessionFactory实例。
2. 重量级。在SessionFactory中存放了Hibernate配置信息以及映射元素据信息，这些都需要很大的缓存。
**一般来说，SessionFactory的主要作用就是创建Session对象，所有的线程都是从SessionFactory中获取Session对象来处理客户请求的。**

>也许你会很好奇，SessionFactory为什么是重量级对象呢？我也同样好奇，通过查看Hibernate的源码，发现 SessionFactory存放了大量预定义的SQL语句以及映射元数据，所以自然需要很大的缓存了，同时需要一定的CPU时间来计算生成。想想 Hibernate的这个设计是很有意义的，因为有了Mapping文件，很多SQL语句就已经确定了，只需要动态生成一次就可以了，这个设计也是为了提 高持久化的效率。

# Session接口
从SessionFactory中可以获得Session实例。
Session接口是Hibernate应用中使用最广泛的接口了，**它是持久化管理器，提供添加、更新、删除、加载、查询对象**。Session的每个方法都值得我们去研究和探讨，不过最常用的还是save、saveOrUpdate、update、delete、createQuery等方法了，关于Session是如何作用的以及它的工作原理在以后的实践中再一步一步的进行学习和探讨！！**Session不是线程安 全的，所以应避免多个线程共享同一个Session实例。**Session是轻量级对象，它的创建和销毁不需要太多资源，这意味着在应用中可以经常创建和销 毁Session对象。
Session有一个缓存，称之为Hibernate的一级缓存，它存放当前工作单元加载的持久化对象，每个Session都有自己的缓存，缓存中的对象只能被当前工作单元访问。