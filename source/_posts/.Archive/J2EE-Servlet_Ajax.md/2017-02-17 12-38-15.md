---
title: Servlet与ajax结合
---
# 项目想法
> 由于老是逛微博，发现每到滑轮到底时就会刷新数据，今天刚好有时间，就自己尝试了一下，由于三大框架还不太熟，所以用的是servlet。后期改成ssh。

# 项目过程
> 由于这是一个小项目，就讲下自己所遇到的问题吧。
## 滑轮触发事件
> `首先:`从前台开始分析，滑轮滚到底会触发一个事件，代码如下:
``` js
$().ready(function(){
	$(window).bind("scroll",function(){
	var $height = $(this).height();//可见高度
	var $contentH = $(document).height();//内容高度
	var $scrollTop = $(this).scrollTop();//滚动的高度
	if(($scrollTop+$height)==$contentH){
		  //加载数据
		}
	})
})
```
> `滚动高度+可见的高度=内容的高度`；本代码是滚轮划到底部时才触发的事件，也可以设置一个范围，将`if`里的内容改成如下代码：`$scrollTop/($contentH-$height)>0.95`

## Ajax加载数据
> 由于本项目比较简单，就采用了`$.post`就行了，这里简单介绍一下`$.post`和`$.ajax`的区别
> `$.post(url, [data], [callback], [type]):`这是一个简单的 POST 请求功能以取代复杂 `$.ajax` 。请求成功时可调用回调函数。如果需要在出错时执行函数，请使用 `$.ajax`。
    - `url:`发送请求地址
    - `data:`待发送 Key/value 参数
    - `callback:`发送成功时回调函数
    - `type:`返回内容格式，xml, html, script, json, text, _default.
> `$.aajax([options]):`jQuery 底层 AJAX 实现。简单易用的高层实现见 $.get, $.post 等。$.ajax() 返回其创建的 `XMLHttpRequest` 对象。大多数情况下你无需直接操作该函数，除非你需要操作不常用的选项，以获得更多的灵活性。 具体请自行百度。

## 具体代码
> 以下代码添加在滑轮触发事件的if内部;
``` js
$.post("${pageContext.request.contextPath}/clientServlet",{
				//待发送的参数
			},function(data){
				    //成功后执行的
				})
			})
```

