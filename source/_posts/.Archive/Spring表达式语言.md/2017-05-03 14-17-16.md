---
title: Spring表达式语言
categories: Spring
---

# 前言
> Spring EL与OGNL和JSF EL相似，计算评估或在bean创建时执行。此外，*所有的Spring表达式都可以通过XML或注解。*
在本教程中，我们将学习如何使用Spring表达式语言(SpEL)，注入字符串，整数，Bean到属性，无论是在XML和注释。

# Spring Beans
> 两个简单Bean，后来利用 SpEL 注入值到属性，在 XML 和 注释。

``` java
package com.yiibai.core;

public class Customer {

	private Item item;

	private String itemName;

}
```
``` java
package com.yiibai.core;

public class Item {

	private String name;

	private int qty;

}
```

# Spring EL以XML形式
> 使用 SpEL关闭的#{ SpEL expression }括号，请参阅XML bean定义文件下面的例子。
``` java
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

	<bean id="itemBean" class="com.yiibai.core.Item">
		<property name="name" value="itemA" />
		<property name="qty" value="10" />
	</bean>

	<bean id="customerBean" class="com.yiibai.core.Customer">
		<property name="item" value="#{itemBean}" />
		<property name="itemName" value="#{itemBean.name}" />
	</bean>
	
</beans>
```
- `#{itemBean}`: 注入`“itemBean”`到`“customerBean”`Bean 的`“item”`属性。
- `#{itemBean.name}`: 注入`“itemBean”`的`“name”`属性到 `“customerBean" `bean的`"itemname”`属性。

# Spring EL以注解形式
## 代码解析
> 要在注解使用使用SpEL，**必须通过注解注册您的组件。如果注册bean在XML和Java类中定义@Value，该@Value将无法执行。**
``` java
package com.yiibai.core;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component("customerBean")
public class Customer {

	@Value("#{itemBean}")
	private Item item;

	@Value("#{itemBean.name}")
	private String itemName;

	//...

}
```
``` java
package com.yiibai.core;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component("itemBean")
public class Item {

	@Value("itemA") //inject String directly
	private String name;

	@Value("10") //inject interger directly
	private int qty;

	public String getName() {
		return name;
	}

	//...
}
```
> 启用自动组件扫描。

``` xml
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context-3.0.xsd">

	<context:component-scan base-package="com.yiibai.core" />

</beans>
```
> 在注解模式下，可以使用`@Value`定义Spring EL。在这种情况下，一个String和Integer值直接注入到“itemBean”，之后又注入“itemBean”到“customerBean”属性。

## 执行输出
> 运行它，无论是使用 SpEL在XML 还是注释都显示了同样的结果：

``` java
package com.yiibai.core;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class App {
	public static void main(String[] args) {
	    ApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");

	    Customer obj = (Customer) context.getBean("customerBean");
	    System.out.println(obj);
	}
}
```
- 输出结果
``` java
Customer [item=Item [name=itemA, qty=10], itemName=itemA]
```

## 详细内容
[Spring EL hello world](http://www.yiibai.com/spring/spring-el-hello-world-example.html)

# Spring EL方法调用实例
## 代码解析
> 了解如何实现Spring EL方法调用与@Value注释
``` java
package com.yiibai.core;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component("customerBean")
public class Customer {

	@Value("#{'yiibai'.toUpperCase()}")
	private String name;

	@Value("#{priceBean.getSpecialPrice()}")
	private double amount;

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public double getAmount() {
		return amount;
	}

	public void setAmount(double amount) {
		this.amount = amount;
	}

	@Override
	public String toString() {
		return "Customer [name=" + name + ", amount=" + amount + "]";
	}

}
```
``` java
package com.yiibai.core;

import org.springframework.stereotype.Component;

@Component("priceBean")
public class Price {

	public double getSpecialPrice() {
		return new Double(199.09);
	}

}
```
- 输出
``` java
Customer [name=YIIBAI, amount=199.09]
```

## 详细内容
[Spring EL方法调用实例](http://www.yiibai.com/spring/spring-el-method-invocation-example.html)

# Spring EL运算符
## 简介
* Spring EL支持大多数标准的数学，逻辑和关系运算符。 例如，
    * `关系运算符:` 等于 (==, eq), 不等于 (!=, ne), 小于 (<, lt), 小于或等于 (<= , le), 大于 (>, gt), 和大于或等于 (>=, ge).
    * `逻辑运算符:`且, 或, 非 (!).
    * `数学运算符:`加法(+), 减法 (-), 乘法 (*), 除法(/), 除模(%) 和指数幂 (^).

## 代码解析
``` java
package com.yiibai.core;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component("customerBean")
public class Customer {

	//Relational operators
	
	@Value("#{1 == 1}") //true
	private boolean testEqual;
	
	@Value("#{1 != 1}") //false
	private boolean testNotEqual;
	
	@Value("#{1 < 1}") //false
	private boolean testLessThan;
	
	@Value("#{1 <= 1}") //true
	private boolean testLessThanOrEqual;
	
	@Value("#{1 > 1}") //false
	private boolean testGreaterThan;
	
	@Value("#{1 >= 1}") //true
	private boolean testGreaterThanOrEqual;

	//Logical operators , numberBean.no == 999
	
	@Value("#{numberBean.no == 999 and numberBean.no < 900}") //false
	private boolean testAnd;
	
	@Value("#{numberBean.no == 999 or numberBean.no < 900}") //true
	private boolean testOr;
	
	@Value("#{!(numberBean.no == 999)}") //false
	private boolean testNot;

	//Mathematical operators
	
	@Value("#{1 + 1}") //2.0
	private double testAdd;
	
	@Value("#{'1' + '@' + '1'}") //1@1
	private String testAddString;
	
	@Value("#{1 - 1}") //0.0
	private double testSubtraction;

	@Value("#{1 * 1}") //1.0
	private double testMultiplication;
	
	@Value("#{10 / 2}") //5.0
	private double testDivision;
	
	@Value("#{10 % 10}") //0.0
	private double testModulus ;
	
	@Value("#{2 ^ 2}") //4.0
	private double testExponentialPower;

	@Override
	public String toString() {
		return "Customer [testEqual=" + testEqual + ", testNotEqual="
				+ testNotEqual + ", testLessThan=" + testLessThan
				+ ", testLessThanOrEqual=" + testLessThanOrEqual
				+ ", testGreaterThan=" + testGreaterThan
				+ ", testGreaterThanOrEqual=" + testGreaterThanOrEqual
				+ ", testAnd=" + testAnd + ", testOr=" + testOr + ", testNot="
				+ testNot + ", testAdd=" + testAdd + ", testAddString="
				+ testAddString + ", testSubtraction=" + testSubtraction
				+ ", testMultiplication=" + testMultiplication
				+ ", testDivision=" + testDivision + ", testModulus="
				+ testModulus + ", testExponentialPower="
				+ testExponentialPower + "]";
	}
	
}
```

## 详情链接
[Spring EL运算符实例](http://www.yiibai.com/spring/spring-el-operators-example.html)

# 更多详情内容
[Spring EL Lists,Maps实例](http://www.yiibai.com/spring/spring-el-lists-maps-example.html)
[Spring EL正则表达式实例](http://www.yiibai.com/spring/spring-el-regular-expression-example.html)