---
title: js相关问题
categories: javascript
---

# 闭包考察
``` js
//输出结果？？如何让其恢复正常
for (var i=0; i<10; ++i) {
    setTimeout( function timer(){
    console.log( i );
    },1000 );
}
//
```
> 解决方案:
``` js
//第一种
for (var i=1; i<=9; i++) {
 (function(j){
     setTimeout( function timer(){
         console.log( j );
     }, 1000 );
 })( i );
}
//第二种
for (var i=1; i<=9; i++) {
 (function(j){
     setTimeout( function timer(){
         console.log( j );
     }, 1000 );
 })( i );
}
```
> 原因解释：这两种方法都不是解决异步问题的，而是解决变量作用域的问题的。
因为函数 timer() 属于一个新的域，通过 var 定义的变量是无法传入到这个函数执行域中的，于是有了你展示的两种解决办法，第一种是通过使用 let 来声明块变量，这时候变量就能作用于这个块，所以 timer 就能使用 i 这个变量了。第二种是通过传入参数，间接的把变量传入到 timer 中。